<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="这题超纲了">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
        
            <link rel="preconnect" href="https://npm.elemecdn.com" crossorigin>
        
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2023/02/25/blog6/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="春宵一刻值千金,花有清香月有阴。 歌管楼台声细细,秋千院落夜沉沉。">
<meta property="og:type" content="article">
<meta property="og:title" content="进程间通信的各种方法以及优缺点">
<meta property="og:url" content="http://example.com/2023/02/25/blog6/index.html">
<meta property="og:site_name">
<meta property="og:description" content="春宵一刻值千金,花有清香月有阴。 歌管楼台声细细,秋千院落夜沉沉。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/02/25/blog6/%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98.jpg">
<meta property="og:image" content="http://example.com/2023/02/25/blog6/%E4%BF%A1%E5%8F%B7%E9%87%8F.jpg">
<meta property="og:image" content="http://example.com/2023/02/25/blog6/%E4%BF%A1%E5%8F%B7%E9%87%8F1.jpg">
<meta property="og:image" content="http://example.com/2023/02/25/blog6/Tcp.jpg">
<meta property="og:image" content="http://example.com/2023/02/25/blog6/Udp.jpg">
<meta property="article:published_time" content="2023-02-25T08:52:51.000Z">
<meta property="article:modified_time" content="2023-06-23T06:32:19.208Z">
<meta property="article:tag" content="操作系统">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/02/25/blog6/%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98.jpg">
    
    
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id="></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/%E6%B4%BE1.jpg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/%E6%B4%BE1.jpg">
    <meta name="theme-color" content="#005080">
    <link rel="shortcut icon" href="/images/%E6%B4%BE1.jpg">
    <!--- Page Info-->
    
    <title>
        
            进程间通信的各种方法以及优缺点 -
        
        这题超纲了的BLOG
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/assets/fonts.css">
    <!--- Font Part-->
    
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    
    
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    
    
        <link href="https://fonts.googleapis.com/css2?family=Farsan&display=swap" rel="stylesheet">
    

    <!--- Inject Part-->
    
        
            
    
            
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":true,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":["铜皮","草根","柳筋","骨气","铸庐","洞府境","观海境","龙门境","金丹境","元婴境","玉璞境","仙人境","飞升境","十四境","十五境"]},"code_block":{"copy":true,"style":"mac","font":{"enable":true,"family":null,"url":"https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;500;600;700&display=swap"}},"toc":{"enable":true,"max_depth":5,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":true,"title":"推荐阅读","limit":3,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#005080","secondary":null},"global":{"fonts":{"chinese":{"enable":true,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"english":{"enable":true,"family":"Farsan","url":"https://fonts.googleapis.com/css2?family=Farsan&display=swap"}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":false,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true,"google_analytics":{"enable":true,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/水墨/水墨.jpg","dark":"/images/水墨/水墨1.jpg"},"title":"~欢迎来到“派大星”的博客~","subtitle":{"text":["言念君子,温其如玉","我见青山多妩媚,料青山见我应如是","有些人心如花木,皆向阳而生","遇事不决,可问春风。春风不语,即随本心","人生当苦无妨,良人当归即好"],"hitokoto":{"enable":true,"api":null},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#000000","dark":"#FAFFFE"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":true,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"social_links":{"enable":"enable","links":{"github":"https://github.com/Qx-GG","instagram":null,"zhihu":"https://www.zhihu.com/people/bu-shang-530bu-gai-ming","twitter":null,"email":null,"weixin":"/images/微信.jpg","bilibili":"https://space.bilibili.com/38628118?spm_id_from=333.1007.0.0"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.1.5","navbar":{"auto_hide":false,"color":{"left":"#FAFFFE","right":"#FAFFFE","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-chart-bar"},"Links":{"path":"/links","icon":"fa-regular fa-link"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/Qx-GG","Bilibili":"https://space.bilibili.com/38628118?spm_id_from=333.1007.0.0"}},"WorMhole":{"path":"https://foreverblog.cn/go.html","icon":"fa-regular fa-planet-ringed"}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"言念君子,温其如玉","links":{"PYQ":{"path":"/shuoshuo","icon":"fa-regular fa-messages"},"Photo":{"path":"/masonry","icon":"fa-regular fa-photo-film"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}}};
    Global.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    Global.data_config = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/fontawesome/fontawesome.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/fontawesome/brands.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/fontawesome/solid.min.css">
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/fontawesome/regular.min.css">
    
    
    
        <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/fontawesome/duotone.min.css">
    
    
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="null" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/%E6%B4%BE1.jpg">
                </a>
            
            <a class="logo-title" href="/">
                
                这题超纲了的BLOG
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        首页
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        归档
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags"  >
                                    
                                        
                                            <i class="fa-regular fa-chart-bar"></i>
                                        
                                        标签
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/links"  >
                                    
                                        
                                            <i class="fa-regular fa-link"></i>
                                        
                                        链接
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/Qx-GG">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://space.bilibili.com/38628118?spm_id_from=333.1007.0.0">BILIBILI
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    target="_blank" rel="noopener" href="https://foreverblog.cn/go.html"  >
                                    
                                        
                                            <i class="fa-regular fa-planet-ringed"></i>
                                        
                                        WORMHOLE
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                首页
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                归档
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/tags"  >
                             
                                
                                    <i class="fa-regular fa-chart-bar"></i>
                                
                                标签
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/links"  >
                             
                                
                                    <i class="fa-regular fa-link"></i>
                                
                                链接
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/Qx-GG">GITHUB</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://space.bilibili.com/38628118?spm_id_from=333.1007.0.0">BILIBILI</a>
                            </li>
                        
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        target="_blank" rel="noopener" href="https://foreverblog.cn/go.html"  >
                             
                                
                                    <i class="fa-regular fa-planet-ringed"></i>
                                
                                WORMHOLE
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
                      
                <div class="article-title">
                    <img src="https://Qx-GG.github.io/images/水墨/水墨7.jpg" alt="进程间通信的各种方法以及优缺点" />
                    <h1 class="article-title-cover">进程间通信的各种方法以及优缺点</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/%E6%B4%BE%E5%A4%A7%E6%98%9F.png">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">这题超纲了</span>
                            
                                <span class="author-label">柳筋</span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-02-25 16:52:51</span>
        <span class="mobile">2023-02-25 16:52</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-06-23 14:32:19</span>
            <span class="mobile">2023-06-23 14:32</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/C/">C++</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Linux/">Linux</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>6.6k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>23 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=507014930&auto=1&height=66"></iframe>

<h2 id="进程间通讯概念"><a href="#进程间通讯概念" class="headerlink" title="进程间通讯概念"></a>进程间通讯概念</h2><ol>
<li>进程是一个独立的资源分配单位，不同的进程(主要指用户进程)之间的资源是独立的，没有关联，无法在一个进程中直接访问另一个进程的资源</li>
<li>但是，进程不是孤立的，不同的进程需要进行信息的交互和状态的传递等等，因此需要进程间通信(IPC,Inter-Process Communication)，</li>
<li>进程间通信的目的<ol>
<li>数据传输:一个进程需要将它的数据发送给另一个进程</li>
<li>通知事件:一个进程需要向另外一个或者一组进程发送信息，通知它(它们)发生了某种事件</li>
<li>资源共享:多个进程之间共享同样的资源。为了做到这一点，需要内核提供<code>互斥</code>和<code>同步</code>机制</li>
<li>进程控制:有些进程希望能完全控制另外一个进程的执行(如Debug进程)，此时控制进程希望能够拦截另一个进程<code>陷入异常</code>，并能够即使知道它的<code>状态改变</code></li>
</ol>
</li>
<li>进程间虽然用户地址空间是独立的，但是它们共享一个内核空间，所以进程想要通信就只能通过内核</li>
</ol>
<h2 id="Linux下进程间的通信方式"><a href="#Linux下进程间的通信方式" class="headerlink" title="Linux下进程间的通信方式"></a>Linux下进程间的通信方式</h2><details class="red" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>同一主机下的进程间通信方式 </summary>
              <div class="content">
              <ol><li>Unix进程间通信方式<ol><li>管道</li><li>信号</li></ol></li><li>System V进程间通信方式 和 POSTX进程间通信方式<ol><li>消息队列</li><li>共享内存</li><li>信号量</li></ol></li></ol>
              </div>
            </details>

<details class="red" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>不同主机(网络)进程间通信方式 </summary>
              <div class="content">
              <p>Socket(套接字)</p>
              </div>
            </details>

<h3 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h3><p>管道又分为匿名管道和有名管道，管道是UNIX系统中IPC（进程通信）的最古老的形式，所有UNIX都支持这种通信机制</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls | wc -l</span><br><span class="line">//中间那个&quot;|&quot;就是在shell脚本下的管道符</span><br></pre></td></tr></table></figure></div>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>管道的特点 </summary>
              <div class="content">
              <ol><li>管道是一个在内核内存中维护的缓冲区，这个缓冲器的存储能力是有限的，不同的操作系统大小不一定相同</li><li>在Linux下，可以说一切皆是文件，其实内核内存中的这个缓冲区也是一个文件，那么可以操作文件的API，同样也能操控缓冲区</li><li>一个管道是一个字节流，使用管理时不存在消息或者消息边界的概念，从管道读取数据的进程可以读取任意大小的数据块，而不管写入进程写入管道的数据块的大小为多少</li><li>通过管道传递的数据时顺序的，从管道中读取出来的字节的顺序和写入的顺序时完全一样的，就像是队列一样，先进先出</li><li>从管道读取数据是一次性操作，只要读取完，那么读取的数据就会被抛弃而不会留在缓冲区以便有更多的空间来写数据，所以无法使用lseek()函数来随机访问数据</li><li>匿名管道只能在具有公共祖先进程的时候(例如：父进程与子进程通信，两个兄弟进程通信)才能使用，有名管道用于无亲缘关系的进程</li></ol>
              </div>
            </details>

<p>管道的数据结构一般都是:环形队列或者循环队列</p>
<h4 id="匿名管道"><a href="#匿名管道" class="headerlink" title="匿名管道"></a>匿名管道</h4><p>匿名管道也叫无名管道，大部分情况下，我们说的管道都是指匿名管道</p>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>为什么匿名管道能够通信 </summary>
              <div class="content">
              <p>当我们对一个进程使用fork()创建一个子进程的时候，子进程会复制一份父进程的内核区，不过其中的进程号是不一样的，同时<code>复制的还有文件描述符表</code>，那么子进程的文件描述符表上也就会有关于管道读写端的记录，这样就能操作同一个管道来进行通信了，这也就意味着，<code>必须要采用fork()函数之前先创建好匿名管道</code></p>
              </div>
            </details>

<h5 id="匿名管道的使用"><a href="#匿名管道的使用" class="headerlink" title="匿名管道的使用"></a>匿名管道的使用</h5><ol>
<li>创建管道<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span> <span class="comment">//需要包含的头文件</span></span></span><br><span class="line">    <span class="type">int</span> pipefd[<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pipe</span><span class="params">(<span class="type">int</span> pipefd[<span class="number">2</span>])</span></span>;</span><br><span class="line">参数:</span><br><span class="line">    pipefd[<span class="number">2</span>]:传出参数，函数调用成功后，pipefd[<span class="number">0</span>]代表读端，pipefd[<span class="number">1</span>]代表写端，都是文件描述符</span><br><span class="line">返回值:</span><br><span class="line">    成功返回<span class="number">0</span>，失败返回<span class="number">-1</span></span><br></pre></td></tr></table></figure></div></li>
<li>查看管道缓冲大小命令<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ulimit -p;</span><br><span class="line">ulimit -p 想要设置的大小(Kbytes)</span><br></pre></td></tr></table></figure></div></li>
<li>查看管道缓冲区大小函数<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">    <span class="function"><span class="type">long</span> <span class="title">fpathconf</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> name)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    int fd:管道的文件描述符</span></span><br><span class="line"><span class="function">    int name:宏值，通过在终端上输入<span class="string">&quot;man 2 fpathconf&quot;</span>查看</span></span><br></pre></td></tr></table></figure></div></li>
<li>&#96;如果管道是空的，read函数会阻塞;如果管道是满的，write函数会阻塞</li>
</ol>
<h5 id="匿名管道的读写特点和如何将管道设置为非阻塞"><a href="#匿名管道的读写特点和如何将管道设置为非阻塞" class="headerlink" title="匿名管道的读写特点和如何将管道设置为非阻塞"></a>匿名管道的读写特点和如何将管道设置为非阻塞</h5><ol>
<li>使用管道时，需要注意的点:<ol>
<li>当多有指向管道<strong>写端</strong>的文件描述符<strong>都关闭了(管道写端引用计数为0)<strong>，有进程从管道的</strong>读端</strong>读取数据，那么当该进程把管道里面剩余的数据读取完后，再次 read就会返回0，就像如到文件末尾一样</li>
<li>如果有指向管道<strong>写段</strong>的文件描述符<strong>没关闭(管道写段引用计数不为0)<strong>，而持有管道</strong>写端</strong>的进程也而没有往里面写数据，当管道的数据被另外一个进程读取完后，再次read时，管道就会变成<strong>阻塞状态</strong>，直到有进程往管道里面写数据才可以再次返回读取数据</li>
<li>如果有指向管道<strong>读端</strong>的文件描述符<strong>都关闭了(管道读端引用计数为0)<strong>，有进程从管道的写端写入数据时，那么该进程就会收到一个</strong>SIGPIPE信号</strong>，通常会导致进程终止</li>
<li>如果有指向管道<strong>读端</strong>的文件描述符<strong>没有关闭(管道读端引用计数不为0)<strong>，而持有管道读端的进程也没有进行读数据操作，当有别的进程往管道里写入数据时，若管道已经被</strong>写满</strong>的话，此时<strong>管道就会变为阻塞状态直到管道读端读取数据</strong>，若没写满的话就还是能继续写入的</li>
</ol>
</li>
<li>如何将管道设置为非阻塞<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fcntl</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> cmd,...)</span></span></span><br></pre></td></tr></table></figure></div>
<details class="green" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>例如:将管道的读端设置为非阻塞 </summary>
              <div class="content">
              <ol><li>先获取原本管道读端的flags<br> int flags&#x3D;fcntl(fd[0],F_GETFL)</li><li>修改flags<br> flags|&#x3D;NONBLOCK(非阻塞)</li><li>设置修改后的flags<br> fcntl(fd[0],F_SETFL,flags)</li></ol>
              </div>
            </details></li>
</ol>
<h4 id="有名管道"><a href="#有名管道" class="headerlink" title="有名管道"></a>有名管道</h4><ol>
<li>有名管道也叫做命名管道、FIFO文件</li>
<li>命名管道(FIFO)不同于匿名之处在于提供了一个路径与之关联，以FIFO的文件形式存在于文件系统中，并且其打开方式与打开一个普通文件是一样的，这样即使与FIFO的创建进程不存在亲缘关系的进程，只要可以访问该路径，就能彼此通过FIFO相互通信，因此，通过FIFO不想管的进程也能交换数据</li>
<li>一旦打开了FIFO，就能在它上面使用与操作匿名管道和其他文件的系统调用一样的I&#x2F;O系统调用API(如read,write,close)。与管道一样，FIFO也有一个写入端和读取端，并且从管道读取数据的顺序与写入顺序是一样的，FIFO(先进先出)名称也由此而来</li>
</ol>
<h5 id="与匿名管道的不同"><a href="#与匿名管道的不同" class="headerlink" title="与匿名管道的不同"></a>与匿名管道的不同</h5><ol>
<li>有名管道能用于无亲缘关系的进程，匿名管道不行</li>
<li>FIFO在文件系统中作为一个特殊文件存在，但FIFO中的内容却存放在<strong>内存</strong>中</li>
<li>当使用FIFO的进程退出后，FIFO文件将继续保存在文件系统中以便以后调用</li>
<li>FIFO有名字，所以不相关的进程可以通过名字打开有名管道进行通信</li>
</ol>
<h5 id="有名管道的使用"><a href="#有名管道的使用" class="headerlink" title="有名管道的使用"></a>有名管道的使用</h5><ol>
<li>通过命令创建有名管道<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfifo 名字</span><br></pre></td></tr></table></figure></div></li>
<li>通过函数创建有名管道<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">mkfifo</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname,<span class="type">mode_t</span> mode)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    *pathname:管道名称的路径，可以是绝对路径也可以是相对路径</span></span><br><span class="line"><span class="function">    mode:文件权限，和open()函数里面的mode是一样的</span></span><br></pre></td></tr></table></figure></div></li>
<li>常见的I&#x2F;O函数都可以用于FIFO</li>
</ol>
<h5 id="有名管道的注意事项"><a href="#有名管道的注意事项" class="headerlink" title="有名管道的注意事项"></a>有名管道的注意事项</h5><ol>
<li>一个为<strong>只读</strong>而打开一个管道的进程会阻塞，直到另外一个进程为<strong>只写</strong>打开管道</li>
<li>读管道读数据:<ol>
<li>管道写端全部关闭:<ol>
<li>管道无数据，read会返回0(相当于读到文件末尾)</li>
<li>管道有数据，先将管道剩余数据读取完，再次read会返回0(相当于读到文件末尾)</li>
</ol>
</li>
<li>管道写端没有全部关闭<ol>
<li>管道无数据，写入数据将管道塞满</li>
<li>管道有数据，写入数据将管道塞满</li>
</ol>
</li>
</ol>
</li>
<li>写管道写数据:<ol>
<li>读端全部关闭，收到一个<strong>SIGPIPE</strong>信号，进程异常终止</li>
<li>读端没有全部关闭:<ol>
<li>管道已经满了，write()会阻塞</li>
<li>管道没有满，write()将数据写入</li>
</ol>
</li>
</ol>
</li>
<li>一个进程只能以一种方式打开有名管道(即要么以只读的方式打开FIFO，要么以只写的方式打开FIFO)，因为如果以又能读又能写的方式打开FIFO的话，该进程就会出现自己读取到自己写入的数据，并且因为被读取完的数据会被丢弃，那样想要通信的另外一个进程就无法获得消息</li>
</ol>
<h4 id="管道的优势和劣势"><a href="#管道的优势和劣势" class="headerlink" title="管道的优势和劣势"></a>管道的优势和劣势</h4><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>优势 </summary>
              <div class="content">
              <p>简单，我们容易得知管道里的数据已经被另外一个进程读取</p>
              </div>
            </details>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>劣势 </summary>
              <div class="content">
              <p>通信效率低下</p>
              </div>
            </details>

<h3 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h3><p>消息队列是保存在内核中的消息链表，在发送数据时，会分成一个一个独立的数据单元，也就是消息体(数据块)，消息体是用户自定义的数据类型，消息的发送方和接收方要约定好消息体的数据类型，所以每个消息体都是固定大小的存储块，不像管道是无格式的字节流数据。如果进程从消息队列中读取了消息体，内核就会把这个消息体删除。</p>
<p><strong>消息这种模型，就好像两个进程发邮件一样，你来一封，我来一封，可以频繁沟通</strong></p>
<h4 id="消息队列的优势和劣势"><a href="#消息队列的优势和劣势" class="headerlink" title="消息队列的优势和劣势"></a>消息队列的优势和劣势</h4><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>优势 </summary>
              <div class="content">
              <p>相对于管道，消息队列交换数据的效率明显提高了</p>
              </div>
            </details>
<details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>劣势 </summary>
              <div class="content">
              <ol><li>通信不及时</li><li>附件大小也有限制</li></ol>
              </div>
            </details>

<h3 id="内存映射"><a href="#内存映射" class="headerlink" title="内存映射"></a>内存映射</h3><p>内存映射(Memory-mapped I&#x2F;O)是将磁盘文件的数据映射到内存，用于通过修改内存就能修改磁盘文件</p>
<h4 id="内存映射的一些API"><a href="#内存映射的一些API" class="headerlink" title="内存映射的一些API"></a>内存映射的一些API</h4><ol>
<li>映射一个文件到内存中，实现文件物理地址和进程虚拟地址的一一对应<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line">    <span class="function"><span class="type">void</span> *<span class="title">mmap</span><span class="params">(<span class="type">void</span> *addr,<span class="type">size_t</span> length,<span class="type">int</span> prot,<span class="type">int</span> flags,<span class="type">int</span> fd,<span class="type">off_t</span> offset)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    *addr: NULL,由内核指定</span></span><br><span class="line"><span class="function">    length: 要映射的数据的长度，这个长度不能为<span class="number">0</span>,建议使用文件的长度(可以通过 stat()/lseek() 函数获取)</span></span><br><span class="line"><span class="function">    prot:对申请内存映射区的操作权限</span></span><br><span class="line"><span class="function">        PROT_EXEC:可执行权限    PROT_READ:可读权限  PROT_WRITE:写权限   PORT_NONE:没有权限</span></span><br><span class="line"><span class="function">        注意:要操作内存，就必须要有读权限</span></span><br><span class="line"><span class="function">    flags:</span></span><br><span class="line"><span class="function">        MAP_SHARED:映射区的数据会自动和磁盘文件进行同步，若要进程间通信，必须要设置这个选项</span></span><br><span class="line"><span class="function">        MAP_PRIVATE:不同步，会重新创建一个新的文件</span></span><br><span class="line"><span class="function">    fd:需要映射的文件的文件描述符</span></span><br><span class="line"><span class="function">        注意:文件大小不能为<span class="number">0</span>，也就是length不能为<span class="number">0</span>，open()指定的权限不能与prot有冲突</span></span><br><span class="line"><span class="function">                prot指定的权限必须小于open()指定的权限，并且两个都需要有读的权限</span></span><br><span class="line"><span class="function">    offset:偏移量，一般不用，要用的话必须是<span class="number">4</span>K的整数倍</span></span><br><span class="line"><span class="function">返回值:</span></span><br><span class="line"><span class="function">    成功返回创建的内存的首地址，失败则返回MAP_FAILED</span></span><br></pre></td></tr></table></figure></div></li>
<li>释放内存映射<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">munmap</span><span class="params">(<span class="type">void</span> *addr,<span class="type">size_t</span> length)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    *addr:要释放的内存的首地址，可以通过mmap函数获取</span></span><br><span class="line"><span class="function">    length:要释放的内存的大小，和mmap函数的length参数的值一样</span></span><br><span class="line"><span class="function">返回值:</span></span><br><span class="line"><span class="function">    成功返回<span class="number">0</span>，失败返回<span class="number">-1</span></span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h3><p>后面会专门写一篇文章来讲信号的，这里就先不多说了</p>
<h3 id="共享内存"><a href="#共享内存" class="headerlink" title="共享内存"></a>共享内存</h3><p>消息队列的读写都发生了用户态到内核态的转变，过多的转变其实也很占用CPU资源，为了减少这种转变，共享内存就很好的解决了这一问题</p>
<p>现代操作系统，对于内存管理，采用的是虚拟内存技术，也就是每个进程都有自己独立的虚拟内存空间，不同进程的虚拟内存映射到不同的物理内存中。所以，即使进程 A 和 进程 B 的虚拟地址是一样的，其实访问的是不同的物理内存地址，对于数据的增删查改互不影响。</p>
<p><strong>共享内存的机制，就是拿出一块虚拟地址空间来</strong>，映射到相同的物理内存中。这样这个进程写入的东西，另外一个进程马上就能看到了，都不需要拷贝来拷贝去，传来传去，大大提高了进程间通信的速度。</p>
<img lazyload src="/images/loading.svg" data-src="/2023/02/25/blog6/%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98.jpg" class title="共享内存">
<p>共享内存是效率最高的通信方式。</p>
<h4 id="共享内存使用步骤"><a href="#共享内存使用步骤" class="headerlink" title="共享内存使用步骤"></a>共享内存使用步骤</h4><details class="red" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>步骤 </summary>
              <div class="content">
              <ol><li>使用shmget()函数创建一个新的共享内存段或者区的一个已有的共享内存段的标识符(就是说有其他进程创建的共享内存段)，这个调用将返回后续调用需要用到的共享内存标识符</li><li>使用shmat()函数来附上共享内存段，即使该段称为调用进程的虚拟内存的一部分</li><li>此时在程序中就可以像对待其他可用内存那样对待这个共享内存段。为引用这块共享内存，程序需要使用由shmat()函数的返回值的addr值(一个指向进程的虚拟地址空间中该共享内存段的起点的指针)</li><li>shmdt()函数用来分离共享内存段。在这个调用之后，进程就无法再引用这块共享内存</li><li>调用shmctl()来删除共享内存段。只有当所有附加内存段的进程都与之分离之后内存段可会销毁，只有一个进程需要执行这一步</li></ol>
              </div>
            </details>
<h4 id="共享内存相关API"><a href="#共享内存相关API" class="headerlink" title="共享内存相关API"></a>共享内存相关API</h4><ol>
<li>创建一个新的共享内存(里面的数据都会被初始化为0)，或者获取一个既有的共享内存的标识<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">shmget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">size_t</span> size, <span class="type">int</span> shmflg)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    key_t key:key_t类型是一个整形，通过这个找到或者创建一个共享内存，一般使用<span class="number">16</span>进制并且不为<span class="number">0</span></span></span><br><span class="line"><span class="function">    size: 共享内存的大小</span></span><br><span class="line"><span class="function">    shmflg:属性</span></span><br><span class="line"><span class="function">            <span class="number">1.</span>访问权限</span></span><br><span class="line"><span class="function">            <span class="number">2.</span>附加权限   创建共享内存(IPC_CREAT)</span></span><br><span class="line"><span class="function">                        判断共享内存是否存在,不存在就创建(IPC_EXCL,需要和IPC_CREAT一起使用)</span></span><br><span class="line"><span class="function">返回值:</span></span><br><span class="line"><span class="function">    成功就返回共享内存的引用ID，后面操作共享内存都是通过这个值</span></span><br><span class="line"><span class="function">    失败就返回<span class="number">-1</span></span></span><br></pre></td></tr></table></figure></div></li>
<li>和当前的进程进行关联<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="type">void</span> *<span class="title">shmat</span><span class="params">(<span class="type">int</span> shmid,<span class="type">const</span> <span class="type">void</span> *shmaddr,<span class="type">int</span> shmflg)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    shmid:共享内存的标识(ID),由shmger返回值获取</span></span><br><span class="line"><span class="function">    shmaddr:申请的共享内存的其实地址，一般指定NULL，由内核来指定</span></span><br><span class="line"><span class="function">    shmflg:对共享内存的操作</span></span><br><span class="line"><span class="function">            读: SHM_REONLY,必须要有读权限</span></span><br><span class="line"><span class="function">            读写: <span class="number">0</span></span></span><br><span class="line"><span class="function">返回值:</span></span><br><span class="line"><span class="function">    成功返回共享内存的起始地址</span></span><br><span class="line"><span class="function">    失败返回<span class="number">-1</span></span></span><br></pre></td></tr></table></figure></div></li>
<li>解除当前进程和共享内存的关联<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="type">int</span> <span class="title">shmdt</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *shmaddr)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    shmaddr:共享内存的首地址(起始地址)，通过shmat函数获得</span></span><br><span class="line"><span class="function">返回值:</span></span><br><span class="line"><span class="function">    成功返回<span class="number">0</span>，失败返回<span class="number">-1</span></span></span><br></pre></td></tr></table></figure></div></li>
<li>对共享内存进行操作，共享内存要删除才会消失，创建共享内存的进程被终止了对共享内存无影响<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="type">int</span> <span class="title">shmctl</span><span class="params">(<span class="type">int</span> shmid,<span class="type">int</span> cmd,<span class="keyword">struct</span> shmid_ds *buf)</span></span></span><br><span class="line"><span class="function">参数: </span></span><br><span class="line"><span class="function">    shmid:共享内存的标识号，通过shmget函数获得</span></span><br><span class="line"><span class="function">    cmd:要对共享内存做的操作</span></span><br><span class="line"><span class="function">        IPC_STAT:获取共享内存的当前状态</span></span><br><span class="line"><span class="function">        IPC_SET:设置共享内存的状态</span></span><br><span class="line"><span class="function">        IPC_RMID:标记共享内存被摧毁</span></span><br><span class="line"><span class="function">    struct shmid_ds *buf:需要设置或获取的共享内存的属性信息</span></span><br><span class="line"><span class="function">        若cmd=</span>IPC_STAT,则buf存储数据</span><br><span class="line">        若cmd=IPC_SET,则buf中需要初始化数据，设置到内核中</span><br><span class="line">        若cmd=IPC_RMID,没用，设置为<span class="built_in">NULL</span></span><br><span class="line">        (<span class="keyword">struct</span> shmid_ds:一个结构体，里面有一个成员shm_nattach,记录了该共享内存关联的进程的个数)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
5.根据指定的路径名和int值，生成一个共享内存的key<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="type">key_t</span> <span class="title">ftok</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname,<span class="type">int</span> proj_id)</span></span></span><br><span class="line"><span class="function">参数:</span></span><br><span class="line"><span class="function">    pathname:指定一个存在的路径</span></span><br><span class="line"><span class="function">    proj_id:int类型的值，但是系统调用智慧使用其中的一个字节(范围:<span class="number">1</span><span class="number">-255</span>,一般指定一个字符<span class="string">&#x27;a&#x27;</span>)</span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<h3 id="信号量"><a href="#信号量" class="headerlink" title="信号量"></a>信号量</h3><p>用了共享内存通信方式，带来新的问题，那就是如果多个进程同时修改同一个共享内存，很有可能就冲突了。例如两个进程都同时写一个地址，那先写的那个进程会发现内容被别人覆盖了。</p>
<p>为了防止多进程竞争共享资源，而造成的数据错乱，所以需要保护机制，使得共享的资源，在任意时刻只能被一个进程访问。正好，<strong>信号量</strong>就实现了这一保护机制。</p>
<p>信号量其实是一个整型的计数器，主要用于实现进程间的互斥与同步，而不是用于缓存进程间通信的数据。</p>
<p>信号量表示资源的数量</p>
<details class="red" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>控制信号量的方式有两种原子操作 </summary>
              <div class="content">
              <ol><li>一个是 P 操作，这个操作会把信号量减去 -1，相减后如果信号量 &lt; 0，则表明资源已被占用，进程需阻塞等待；相减后如果信号量 &gt;&#x3D; 0，则表明还有资源可使用，进程可正常继续执行。</li><li>另一个是 V 操作，这个操作会把信号量加上 1，相加后如果信号量 &lt;&#x3D; 0，则表明当前有阻塞中的进程，于是会将该进程唤醒运行；相加后如果信号量 &gt; 0，则表明当前没有阻塞中的进程；</li></ol>
              </div>
            </details>
<p>P 操作是用在进入共享资源之前，V 操作是用在离开共享资源之后，这两个操作是必须成对出现的。</p>
<p>接下来，举个例子，如果要使得两个进程互斥访问共享内存，我们可以初始化信号量为 1。</p>
<img lazyload src="/images/loading.svg" data-src="/2023/02/25/blog6/%E4%BF%A1%E5%8F%B7%E9%87%8F.jpg" class title="信号量">
<details class="yellow" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>具体过程 </summary>
              <div class="content">
              <ol><li>进程 A 在访问共享内存前，先执行了 P 操作，由于信号量的初始值为 1，故在进程 A 执行 P 操作后信号量变为 0，表示共享资源可用，于是进程 A 就可以访问共享内存。</li><li>若此时，进程 B 也想访问共享内存，执行了 P 操作，结果信号量变为了 -1，这就意味着临界资源已被占用，因此进程 B 被阻塞。</li><li>直到进程 A 访问完共享内存，才会执行 V 操作，使得信号量恢复为 0，接着就会唤醒阻塞中的线程 B，使得进程 B 可以访问共享内存，最后完成共享内存的访问后，执行 V 操作，使信号量恢复到初始值 1。</li></ol>
              </div>
            </details>

<p>可以发现，信号初始化为 1，就代表着是<strong>互斥信号量</strong>，它可以保证共享内存在任何时刻只有一个进程在访问，这就很好的保护了共享内存。</p>
<p>另外，在多进程里，每个进程并不一定是顺序执行的，它们基本是以各自独立的、不可预知的速度向前推进，但有时候我们又希望多个进程能密切合作，以实现一个共同的任务。</p>
<p>例如，进程 A 是负责生产数据，而进程 B 是负责读取数据，这两个进程是相互合作、相互依赖的，进程 A 必须先生产了数据，进程 B 才能读取到数据，所以执行是有前后顺序的。</p>
<p>那么这时候，就可以用信号量来实现多进程同步的方式，我们可以初始化信号量为 0。</p>
<img lazyload src="/images/loading.svg" data-src="/2023/02/25/blog6/%E4%BF%A1%E5%8F%B7%E9%87%8F1.jpg" class title="信号量">
<details class="yellow" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>具体过程 </summary>
              <div class="content">
              <ol><li>如果进程 B 比进程 A 先执行了，那么执行到 P 操作时，由于信号量初始值为 0，故信号量会变为 -1，表示进程 A 还没生产数据，于是进程 B 就阻塞等待；</li><li>接着，当进程 A 生产完数据后，执行了 V 操作，就会使得信号量变为 0，于是就会唤醒阻塞在 P 操作的进程 B；</li><li>最后，进程 B 被唤醒后，意味着进程 A 已经生产了数据，于是进程 B 就可以正常读取数据了。</li></ol>
              </div>
            </details>
<p>可以发现，信号初始化为 0，就代表着是同步信号量，它可以保证进程 A 应在进程 B 之前执行。</p>
<h3 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h3><p>前面提到的管道、消息队列、内存映射、共享内存、信号量和信号都是在同一台主机上进行进程间通信，那要想跨网络与不同主机上的进程之间通信，就需要<strong>Socket</strong>通信了。</p>
<p>实际上，Socket 通信不仅可以跨网络与不同主机的进程间通信，还可以在同主机上进程间通信。</p>
<h4 id="针对TCP协议的Socket编程模型"><a href="#针对TCP协议的Socket编程模型" class="headerlink" title="针对TCP协议的Socket编程模型"></a>针对TCP协议的Socket编程模型</h4><img lazyload src="/images/loading.svg" data-src="/2023/02/25/blog6/Tcp.jpg" class title="Tcp">

<ol>
<li>服务端和客户端初始化 socket，得到文件描述符；</li>
<li>服务端调用 bind，将绑定在 IP 地址和端口;</li>
<li>服务端调用 listen，进行监听；</li>
<li>服务端调用 accept，等待客户端连接；</li>
<li>客户端调用 connect，向服务器端的地址和端口发起连接请求；</li>
<li>服务端 accept 返回用于传输的 socket 的文件描述符；</li>
<li>客户端调用 write 写入数据；服务端调用 read 读取数据；</li>
<li>客户端断开连接时，会调用 close，那么服务端 read 读取数据的时候，就会读取到了 EOF，待处理完数据后，服务端调用 close，表示连接关闭。</li>
</ol>
<p>这里需要注意的是，服务端调用 accept 时，连接成功了会返回一个已完成连接的 socket，后续用来传输数据。</p>
<p>所以，监听的 socket 和真正用来传送数据的 socket，是「两个」 socket，一个叫作监听 socket，一个叫作已完成连接 socket。</p>
<p>成功连接建立之后，双方开始通过 read 和 write 函数来读写数据，就像往一个文件流里面写东西一样。</p>
<h4 id="针对UDP协议的Socket编程模型"><a href="#针对UDP协议的Socket编程模型" class="headerlink" title="针对UDP协议的Socket编程模型"></a>针对UDP协议的Socket编程模型</h4><img lazyload src="/images/loading.svg" data-src="/2023/02/25/blog6/Udp.jpg" class title="Udp">
<p>UDP 是没有连接的，所以不需要三次握手，也就不需要像 TCP 调用 listen 和 connect，但是 UDP 的交互仍然需要 IP 地址和端口号，因此也需要 bind。</p>
<p>对于 UDP 来说，不需要要维护连接，那么也就没有所谓的发送方和接收方，甚至都不存在客户端和服务端的概念，只要有一个 socket 多台机器就可以任意通信，因此每一个 UDP 的 socket 都需要 bind。</p>
<p>另外，每次通信时，调用 sendto 和 recvfrom，都要传入目标主机的 IP 地址和端口。</p>
<h4 id="针对本地进程间通信的Socket编程模型"><a href="#针对本地进程间通信的Socket编程模型" class="headerlink" title="针对本地进程间通信的Socket编程模型"></a>针对本地进程间通信的Socket编程模型</h4><p>本地 socket  被用于在<strong>同一台主机上进程间通信</strong>的场景：</p>
<ol>
<li>本地 socket 的编程接口和 IPv4 、IPv6 套接字编程接口是一致的，可以支持「字节流」和「数据报」两种协议；</li>
<li>本地 socket 的实现效率大大高于 IPv4 和 IPv6 的字节流、数据报 socket 实现；</li>
<li>对于本地字节流 socket，其 socket 类型是 AF_LOCAL 和 SOCK_STREAM。</li>
<li>对于本地数据报 socket，其 socket 类型是 AF_LOCAL 和 SOCK_DGRAM。</li>
</ol>
<p>本地字节流 socket 和 本地数据报 socket 在 bind 的时候，不像 TCP 和 UDP 要绑定 IP 地址和端口，而是绑定<strong>一个本地文件</strong>，这也就是它们之间的最大区别。</p>
<h4 id="Socket相关的API"><a href="#Socket相关的API" class="headerlink" title="Socket相关的API"></a>Socket相关的API</h4><p>太多了，这里就不多说了，不懂得可以去看这篇文章:<a class="link" target="_blank" rel="noopener" href="http://t.csdn.cn/EoIzG">http://t.csdn.cn/EoIzG <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>鼠鼠今天看到一个真实故事，大概讲的就就一个人的前女友脑出血成为了植物人，主人公和她已经和平分手1年了，突然有一天主人公接到了前女友的姐姐的电话，得知了前女友发生的事，然后展开的一个故事，里面的一句话让我特别难过”她听完我的录音后，并没有醒过来，那一刻，我多么希望电视剧里的憨憨剧情是真的”，不管是这个，里面还有着女主的哥哥写的一封信，令我特别特别难过，我多希望女主能像电视剧里面醒过来啊，但事与愿违，女主最后还是成为了天边的一朵云彩…</p>
<p>真的还蛮难过的，听主人公的描述，女主是一个善良天真的女孩，她才活了20几年啊，为什么这种事情会发生在她身上呢?世界上确实是有人该死的，但那一定不会是善良和好人啊，我们总之在担心以后的事情，但我们谁也没办法知道，意外和明天哪一个先到来，看完这个故事我又拾起了以前写遗书的想法，我想我大概会写一封遗书，我会一直去修改，如果有一天我的生命定格在了某一刻，那我希望有人能在我的博客上解开我的密码，替我完成我还未完成的心愿，只是现在的我还有太多事没做了，我还不能死</p>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 进程间通信的各种方法以及优缺点</li>
        <li><strong>作者:</strong> 这题超纲了</li>
        <li><strong>创建于:</strong> 2023-02-25 16:52:51</li>
        
            <li>
                <strong>更新于:</strong> 2023-06-23 14:32:19
            </li>
        
        <li>
            <strong>链接:</strong> https://qx-gg.github.io/2023/02/25/blog6/
        </li>
        <li>
            <strong>版权声明:</strong> 本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 进行许可。
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">#操作系统</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/C/">#C++</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Linux/">#Linux</a>&nbsp;
                        </li>
                    
                </ul>
            

            <div class="recommended-article">
  <div class="recommended-article-header">
    <i aria-hidden="true"></i><span>推荐阅读</span>
  </div>
  <div class="recommended-article-group"><a class="recommended-article-item" href="/2023/02/24/blog5/" title="浙江宇视科技一面" rel="bookmark">
  <img src="https://Qx-GG.github.io/images/水墨/水墨6.jpg" alt="浙江宇视科技一面">
  <span class="title">浙江宇视科技一面</span>
</a><a class="recommended-article-item" href="/2023/03/07/blog10/" title="操作系统中的内存管理" rel="bookmark">
  <img src="https://Qx-GG.github.io/images/水墨/水墨11.jpg" alt="操作系统中的内存管理">
  <span class="title">操作系统中的内存管理</span>
</a><a class="recommended-article-item" href="/2023/02/27/blog7/" title="信号量以及一些互斥同步模型" rel="bookmark">
  <img src="https://Qx-GG.github.io/images/水墨/水墨8.jpg" alt="信号量以及一些互斥同步模型">
  <span class="title">信号量以及一些互斥同步模型</span>
</a></div>
</div>

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/02/26/day1/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">随笔·广州·开学后的第一个周末</span>
                                    <span class="post-nav-item">上一篇</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/02/24/blog5/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">浙江宇视科技一面</span>
                                    <span class="post-nav-item">下一篇</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;评论
    </div>
    

        
            
 
    <div id="waline"></div>
    <script type="module"  data-pjax>
        import { init } from 'https://evan.beee.top/js/waline.mjs';

        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://waline-qin.6eek.net',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
            });
        }

        if ('true') {
            const loadWalineTimeout = setTimeout(() => {
                loadWaline();
                clearTimeout(loadWalineTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadWaline);
        }
        
    </script>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">进程间通信的各种方法以及优缺点</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E8%AE%AF%E6%A6%82%E5%BF%B5"><span class="nav-text">进程间通讯概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E4%B8%8B%E8%BF%9B%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="nav-text">Linux下进程间的通信方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E9%81%93"><span class="nav-text">管道</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%BF%E5%90%8D%E7%AE%A1%E9%81%93"><span class="nav-text">匿名管道</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%BF%E5%90%8D%E7%AE%A1%E9%81%93%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">匿名管道的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%BF%E5%90%8D%E7%AE%A1%E9%81%93%E7%9A%84%E8%AF%BB%E5%86%99%E7%89%B9%E7%82%B9%E5%92%8C%E5%A6%82%E4%BD%95%E5%B0%86%E7%AE%A1%E9%81%93%E8%AE%BE%E7%BD%AE%E4%B8%BA%E9%9D%9E%E9%98%BB%E5%A1%9E"><span class="nav-text">匿名管道的读写特点和如何将管道设置为非阻塞</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%90%8D%E7%AE%A1%E9%81%93"><span class="nav-text">有名管道</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8E%E5%8C%BF%E5%90%8D%E7%AE%A1%E9%81%93%E7%9A%84%E4%B8%8D%E5%90%8C"><span class="nav-text">与匿名管道的不同</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%89%E5%90%8D%E7%AE%A1%E9%81%93%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">有名管道的使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%89%E5%90%8D%E7%AE%A1%E9%81%93%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">有名管道的注意事项</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%A1%E9%81%93%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF"><span class="nav-text">管道的优势和劣势</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="nav-text">消息队列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF"><span class="nav-text">消息队列的优势和劣势</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84"><span class="nav-text">内存映射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%E7%9A%84%E4%B8%80%E4%BA%9BAPI"><span class="nav-text">内存映射的一些API</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7"><span class="nav-text">信号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text">共享内存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="nav-text">共享内存使用步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3API"><span class="nav-text">共享内存相关API</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E9%87%8F"><span class="nav-text">信号量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Socket"><span class="nav-text">Socket</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%92%88%E5%AF%B9TCP%E5%8D%8F%E8%AE%AE%E7%9A%84Socket%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">针对TCP协议的Socket编程模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%92%88%E5%AF%B9UDP%E5%8D%8F%E8%AE%AE%E7%9A%84Socket%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">针对UDP协议的Socket编程模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E6%9C%AC%E5%9C%B0%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E7%9A%84Socket%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">针对本地进程间通信的Socket编程模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Socket%E7%9B%B8%E5%85%B3%E7%9A%84API"><span class="nav-text">Socket相关的API</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AF%AD"><span class="nav-text">结语</span></a></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2023</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">这题超纲了</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" href="https://hexo.io">Hexo</a> 驱动</span>
                <br>
            <span class="theme-version-container">主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.1.5</a>
        </div>
        
        
        
            <div id="start_div" style="display:none">
                2023/2/23 15:15:11
            </div>
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <div class="customize-info info-item">和我一起去充满橘子味的村庄叭</div>
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
            
                
        
                
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>



<script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/layouts/navbarShrink.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/scrollTopBottom.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/lightDarkSwitch.js"></script>


    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/localSearch.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/codeBlock.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/layouts/lazyload.js"></script>



    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/runtime.js"></script>
    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/libs/odometer.min.js"></script>
    <link rel="stylesheet" href="//npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/assets/odometer-theme-minimal.css">



  <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/libs/Typed.min.js"></script>
  <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/plugins/typed.js"></script>





    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/libs/minimasonry.min.js"></script>
    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/plugins/masonry.js"></script>


<div class="post-scripts pjax">
    
        <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/tools/tocToggle.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/libs/anime.min.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/layouts/toc.js"></script><script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/plugins/tabs.js"></script>
    
</div>


    <script src="https://npm.elemecdn.com/hexo-theme-redefine@2.1.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>




</body>
</html>
